package plugins

import "fmt"

var createDatabaseSql = "create database if not exists starrocks_audit_db__"

var createTableSql = fmt.Sprintf("CREATE TABLE if not exists starrocks_audit_db__.starrocks_audit_tbl__ (\n  `queryId` VARCHAR(48) COMMENT \"查询的唯一ID\",\n  `timestamp` DATETIME NOT NULL COMMENT \"查询开始时间\",\n  `clientIp` VARCHAR(32) COMMENT \"客户端IP\",\n  `user` VARCHAR(64) COMMENT \"查询用户名\",\n  `authorizedUser` VARCHAR(64) COMMENT \"用户唯一标识，即user_identity\",\n  `resourceGroup` VARCHAR(64) COMMENT \"资源组名\",\n  `catalog` VARCHAR(32) COMMENT \"数据目录名\",\n  `db` VARCHAR(96) COMMENT \"查询所在数据库\",\n  `state` VARCHAR(8) COMMENT \"查询状态（EOF，ERR，OK）\",\n  `errorCode` VARCHAR(96) COMMENT \"错误码\",\n  `queryTime` BIGINT COMMENT \"查询执行时间（毫秒）\",\n  `scanBytes` BIGINT COMMENT \"查询扫描的字节数\",\n  `scanRows` BIGINT COMMENT \"查询扫描的记录行数\",\n  `returnRows` BIGINT COMMENT \"查询返回的结果行数\",\n  `cpuCostNs` BIGINT COMMENT \"查询CPU耗时（纳秒）\",\n  `memCostBytes` BIGINT COMMENT \"查询消耗内存（字节）\",\n  `stmtId` INT COMMENT \"SQL语句增量ID\",\n  `isQuery` TINYINT COMMENT \"SQL是否为查询（1或0）\",\n  `feIp` VARCHAR(32) COMMENT \"执行该语句的FE IP\",\n  `stmt` STRING COMMENT \"SQL原始语句\",\n  `digest` VARCHAR(32) COMMENT \"慢SQL指纹\",\n  `planCpuCosts` DOUBLE COMMENT \"查询规划阶段CPU占用（纳秒）\",\n  `planMemCosts` DOUBLE COMMENT \"查询规划阶段内存占用（字节）\"\n) ENGINE = OLAP\nDUPLICATE KEY (`queryId`, `timestamp`, `clientIp`)\nCOMMENT \"审计日志表\"\nPARTITION BY RANGE (`timestamp`) ()\nDISTRIBUTED BY HASH (`queryId`) BUCKETS 3 \nPROPERTIES (\n  \"dynamic_partition.time_unit\" = \"DAY\",\n  \"dynamic_partition.start\" = \"-30\",\n  \"dynamic_partition.end\" = \"3\",\n  \"dynamic_partition.prefix\" = \"p\",\n  \"dynamic_partition.buckets\" = \"3\",\n  \"dynamic_partition.enable\" = \"true\",\n  \"replication_num\" = \"%%d\" \n)")
